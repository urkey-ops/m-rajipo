<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mission Rajipo - Mobile Optimized</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/20GQR+q1U/G1bYfQYy9kH9hT7p0uE/I8T2OQ+YQ+c2wJpC8XvPqjG6Jg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<style>
  body { background-color: #f7fafc; min-height: 100vh; padding-bottom: 100px; }
  .track-item.selected { background-color: #3b82f6; color: white; }
  .group-btn.selected { background-color: #3b82f6; color: white; }
  .checkmark { display: none; position: absolute; top: 4px; right: 6px; font-size: 1.25rem; }
  .group-btn.selected .checkmark { display: block; }
  .countdown-bar { height: 6px; background: #3b82f6; transition: width 1s linear; }
</style>
</head>
<body class="flex flex-col">

<div class="max-w-md mx-auto p-4 flex flex-col flex-1">

  <h1 class="text-2xl font-bold text-center mb-4 text-gray-800">ðŸŽµ Mission Rajipo</h1>

  <!-- Search + Range -->
  <div class="space-y-3 mb-3">
    <input id="search" type="text" placeholder="Search shlok number..." class="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
    <div class="flex gap-2">
      <input id="rangeStart" type="number" min="1" max="315" placeholder="Start" class="w-1/2 p-2 border rounded">
      <input id="rangeEnd" type="number" min="1" max="315" placeholder="End" class="w-1/2 p-2 border rounded">
      <button onclick="selectRange()" class="px-2 py-2 bg-green-500 text-white rounded flex items-center gap-1">
        <i class="fa-solid fa-list-ol"></i> Range
      </button>
    </div>
  </div>

  <!-- Groups Toggle -->
  <button onclick="toggleGroupDisplay()" class="w-full py-3 bg-blue-500 text-white rounded font-bold flex items-center justify-center gap-2 mb-3">
    <i class="fa-solid fa-layer-group"></i> Groups
  </button>
  <div id="groups" class="grid grid-cols-3 gap-2 justify-items-center mb-3 hidden"></div>

  <!-- Playback Controls -->
  <div id="regularControls" class="mb-3 space-y-2">
    <div class="flex justify-between items-center gap-2">
      <label class="flex-1 flex items-center gap-1">Repeat: <input id="repeatCount" type="number" min="1" value="1" class="w-16 p-1 border rounded text-center"></label>
      <label class="flex items-center gap-1"><input type="checkbox" id="shuffle"> Shuffle</label>
      <label class="flex items-center gap-1"><input type="checkbox" id="repeatPlaylist"> Repeat</label>
    </div>
    <div class="flex justify-between items-center gap-2">
      <label>Speed:</label>
      <button onclick="changeSpeed(-0.1)" class="px-3 py-1 bg-gray-300 rounded hover:bg-gray-400">-</button>
      <span id="speedDisplay" class="font-semibold w-8 text-center">1.0</span>x
      <button onclick="changeSpeed(0.1)" class="px-3 py-1 bg-gray-300 rounded hover:bg-gray-400">+</button>
    </div>
    <div class="flex flex-col gap-2 sm:flex-row">
      <button onclick="playSelected()" class="flex-1 py-3 bg-blue-600 text-white rounded font-bold flex items-center justify-center gap-2">
        <i class="fa-solid fa-play"></i> Play
      </button>
      <button onclick="clearSelection()" class="flex-1 py-3 bg-red-500 text-white rounded font-bold flex items-center justify-center gap-2">
        <i class="fa-solid fa-eraser"></i> Clear
      </button>
    </div>
  </div>

  <!-- Track List -->
  <ul id="trackList" class="grid grid-cols-1 gap-2 overflow-y-auto flex-1"></ul>

  <!-- Quiz Controls -->
  <div id="quizControls" class="mt-3 space-y-2 hidden">
    <p id="currentShlokQuiz" class="text-center text-lg font-semibold" aria-live="polite">Shlok 0</p>
    <div id="quizStatus" class="hidden text-center text-green-600 font-semibold">
      Audio Paused. Your turn! <span id="countdown" aria-live="polite"></span>
      <div class="w-full bg-gray-300 rounded mt-1">
        <div id="countdownBar" class="countdown-bar w-full rounded"></div>
      </div>
    </div>
    <div class="flex justify-between items-center gap-2">
      <button id="autoPlayToggle" onclick="toggleAutoPlay()" class="flex-1 py-2 bg-gray-400 text-white rounded hover:bg-gray-500 gap-1 flex justify-center items-center">
        <i class="fa-solid fa-circle-play"></i> Auto: OFF
      </button>
      <div id="autoPlayTimeContainer" class="flex-1 hidden justify-between items-center gap-1">
        <button onclick="changeQuizTime(-10)" class="px-2 py-1 bg-gray-300 rounded hover:bg-gray-400">-</button>
        <span id="quizTimeDisplay">30s</span>
        <button onclick="changeQuizTime(10)" class="px-2 py-1 bg-gray-300 rounded hover:bg-gray-400">+</button>
      </div>
    </div>
    <button onclick="playNextQuizTrack()" class="w-full py-3 bg-blue-600 text-white rounded font-bold hover:bg-blue-700 flex items-center justify-center gap-2">
      <i class="fa-solid fa-forward"></i> Next
    </button>
  </div>

  <!-- Recently Played -->
  <div id="recentlyPlayed" class="mt-3 hidden">
    <h2 class="text-gray-800 font-semibold mb-1">Recently Played</h2>
    <ul id="recentList" class="space-y-1"></ul>
    <button onclick="clearHistory()" class="w-full py-2 bg-gray-400 text-white rounded hover:bg-gray-500 flex items-center justify-center gap-2 mt-1">
      <i class="fa-solid fa-trash-can"></i> Clear History
    </button>
  </div>

</div>

<!-- Footer Audio Player -->
<footer class="fixed bottom-0 left-0 right-0 bg-white shadow">
  <audio id="audioPlayer" controls class="w-full h-14"></audio>
</footer>

<script>
/* Copy your entire original JS logic here, unchanged */
/* Including: generateTracks(), generateGroups(), playSelected(), playCurrent(), quiz mode, recent selections, etc. */

// Example minimal track generation to test layout:
const trackListEl = document.getElementById("trackList");
const totalTracks = 315;
function generateTracks() {
  for(let i=1;i<=totalTracks;i++){
    const li = document.createElement("li");
    li.innerHTML = `<label class="block p-2 bg-white rounded shadow cursor-pointer track-item"><input type="checkbox" value="${i}" class="trackBox mr-2"> Shlok ${i}</label>`;
    trackListEl.appendChild(li);
  }
}
generateTracks();

// Make sure to call generateGroups() and restoreLastSelection() from original JS
</script>

</body>
</html>
